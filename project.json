{
  "name": "monorepo",
  "$schema": "node_modules/nx/schemas/project-schema.json",
  "projectType": "application",
  "targets": {
    "lint": {
      "executor": "nx:run-commands",
      "options": {
        "command": "eslint {args} --config eslint.config.base.ts --no-error-on-unmatched-pattern '*.ts' '*.js' '*.json' '*.md' 'scripts/' 'documentation/' 'infrastructure/'",
        "cwd": "{projectRoot}"
      },
      "configurations": {
        "check": {
          "command": "eslint {args} --config eslint.config.base.ts --no-error-on-unmatched-pattern '*.ts' '*.js' '*.json' '*.md' 'scripts/' 'documentation/' 'infrastructure/'"
        },
        "write": {
          "command": "eslint {args} --fix --config eslint.config.base.ts --no-error-on-unmatched-pattern '*.ts' '*.js' '*.json' '*.md' 'scripts/' 'documentation/' 'infrastructure/'"
        }
      },
      "defaultConfiguration": "check",
      "cache": true,
      "description": "Lint workspace root files (config files, scripts, documentation, infrastructure, markdown) excluding NX projects"
    },
    "typecheck": {
      "executor": "nx:run-commands",
      "options": {
        "command": "tsc --noEmit",
        "cwd": "{projectRoot}"
      },
      "description": "Type-check workspace root TypeScript files"
    },
    "format": {
      "executor": "nx:run-commands",
      "options": {
        "command": "prettier {args} --ignore-unknown .",
        "cwd": "{projectRoot}"
      },
      "configurations": {
        "check": {
          "command": "prettier {args} --check --ignore-unknown ."
        },
        "write": {
          "command": "prettier {args} --write --ignore-unknown ."
        }
      },
      "defaultConfiguration": "write",
      "cache": true,
      "description": "Format workspace root files with Prettier (excluding NX projects)"
    },
    "terraform:import": {
      "executor": "nx:run-commands",
      "options": {
        "command": "./scripts/terraform-import.sh",
        "cwd": "{projectRoot}"
      },
      "description": "Import existing infrastructure resources into Terraform state"
    },
    "terraform:plan": {
      "executor": "nx:run-commands",
      "options": {
        "command": "./scripts/terraform-plan.sh",
        "cwd": "{projectRoot}"
      },
      "description": "Run terraform plan to preview infrastructure changes"
    },
    "check-lockfile": {
      "executor": "nx:run-commands",
      "options": {
        "command": "bash scripts/check-lockfile.sh",
        "cwd": "{projectRoot}"
      },
      "description": "Verify that pnpm-lock.yaml is in sync with package.json files"
    },
    "yaml-lint": {
      "executor": "nx:run-commands",
      "options": {
        "command": "eslint {args} --config eslint.config.base.ts --no-error-on-unmatched-pattern '**/*.{yml,yaml}'",
        "cwd": "{projectRoot}"
      },
      "configurations": {
        "check": {
          "command": "eslint {args} --config eslint.config.base.ts --no-error-on-unmatched-pattern '**/*.{yml,yaml}'"
        },
        "write": {
          "command": "eslint {args} --fix --config eslint.config.base.ts --no-error-on-unmatched-pattern '**/*.{yml,yaml}'"
        }
      },
      "defaultConfiguration": "check",
      "cache": true,
      "description": "Lint YAML files"
    },
    "knip": {
      "executor": "nx:run-commands",
      "options": {
        "command": "NODE_OPTIONS='--import=tsx/esm' knip --workspace .",
        "cwd": "{projectRoot}"
      },
      "configurations": {
        "check": {
          "command": "NODE_OPTIONS='--import=tsx/esm' knip --workspace ."
        },
        "write": {
          "command": "NODE_OPTIONS='--import=tsx/esm' knip --fix --workspace ."
        }
      },
      "defaultConfiguration": "check",
      "cache": true,
      "description": "Check for unused files, dependencies, and exports in workspace root only"
    },
    "static-code-analysis": {
      "executor": "nx:run-commands",
      "options": {
        "commands": [
          "nx run monorepo:typecheck",
          "nx run monorepo:lint:{args.configuration}",
          "nx run monorepo:format:{args.configuration}",
          "nx run monorepo:knip:{args.configuration}",
          "nx run monorepo:yaml-lint:{args.configuration}"
        ],
        "cwd": "{projectRoot}"
      },
      "configurations": {
        "check": {
          "parallel": true
        },
        "write": {
          "parallel": false
        }
      },
      "defaultConfiguration": "check",
      "cache": true,
      "description": "Run all static code analysis tools (typecheck, lint, format, knip, yaml-lint)"
    },
    "audit": {
      "executor": "nx:run-commands",
      "options": {
        "command": "pnpm audit --audit-level=moderate"
      },
      "cache": false,
      "description": "Scan for security vulnerabilities in dependencies"
    },
    "audit-fix": {
      "executor": "nx:run-commands",
      "options": {
        "command": "pnpm audit --fix"
      },
      "cache": false,
      "description": "Automatically fix security vulnerabilities where possible"
    },
    "check-updates": {
      "executor": "nx:run-commands",
      "options": {
        "command": "ncu --workspaces --root"
      },
      "cache": false,
      "description": "Check for dependency updates across all workspaces"
    },
    "update-deps": {
      "executor": "nx:run-commands",
      "options": {
        "command": "ncu --workspaces --root -u && pnpm install"
      },
      "cache": false,
      "description": "Update dependencies to latest versions"
    },
    "spell-check": {
      "executor": "nx:run-commands",
      "options": {
        "command": "cspell \"**/*.{ts,tsx,js,jsx,md,yaml,yml,json}\" --no-progress",
        "cwd": "{workspaceRoot}"
      },
      "cache": true,
      "inputs": [
        "default",
        "{workspaceRoot}/**/*.{ts,tsx,js,jsx,md,yaml,yml,json}",
        "{workspaceRoot}/cspell.config.yaml"
      ],
      "description": "Check spelling across the entire codebase"
    },
    "markdown-lint": {
      "executor": "nx:run-commands",
      "options": {
        "command": "markdownlint-cli2 \"**/*.md\"",
        "cwd": "{workspaceRoot}"
      },
      "configurations": {
        "check": {
          "command": "markdownlint-cli2 \"**/*.md\""
        },
        "fix": {
          "command": "markdownlint-cli2 --fix \"**/*.md\""
        }
      },
      "defaultConfiguration": "check",
      "cache": true,
      "inputs": [
        "default",
        "{workspaceRoot}/**/*.md",
        "{workspaceRoot}/.markdownlint-cli2.jsonc"
      ],
      "description": "Lint markdown files across the entire codebase"
    },
    "license-check": {
      "executor": "nx:run-commands",
      "options": {
        "command": "license-checker --json --onlyAllow 'MIT;Apache-2.0;BSD-2-Clause;BSD-3-Clause;ISC;0BSD;CC0-1.0;Unlicense;Python-2.0;CC-BY-3.0;CC-BY-4.0' --production --excludePrivatePackages",
        "cwd": "{workspaceRoot}"
      },
      "cache": true,
      "inputs": [
        "default",
        "{workspaceRoot}/package.json",
        "{workspaceRoot}/pnpm-lock.yaml",
        "{workspaceRoot}/.license-checker.json"
      ],
      "description": "Check licenses of production dependencies"
    }
  }
}
